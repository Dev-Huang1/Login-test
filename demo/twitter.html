<!DOCTYPE html>
<html>
<head>
  <title>Twitter Login</title>
</head>
<body>
  <h1>Login with Twitter</h1>
  <a href="https://api.twitter.com/oauth/authorize?oauth_token=1761433358155063296-nnaU9APCcbtJXXxJ1Kue7hCpp2lBnZ">
    <img src="https://twitter.com/static/images/twitter-login-button.png" alt="Twitter Logo">
  </a>

  <div id="user-info"></div>

  <script>
    function handleLoginCallback() {
      var oauthToken = getParameterByName('oauth_token');
      var oauthVerifier = getParameterByName('oauth_verifier');

      // 使用授权令牌和验证器获取用户信息
      var xhr = new XMLHttpRequest();
      xhr.open('POST', 'https://api.twitter.com/1.1/account/verify_credentials.json');
      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
      xhr.onload = function() {
        if (xhr.status === 200) {
          var userInfo = JSON.parse(xhr.responseText);
          displayUserInfo(userInfo);
        } else {
          console.error('获取用户信息失败：', xhr.status);
        }
      };
      xhr.send('oauth_consumer_key=N1ioPCTvZlGGW6ky6bj237OgK&oauth_token=' + oauthToken + '&oauth_verifier=' + oauthVerifier);
    }

    function getParameterByName(name) {
      var url = window.location.href;
      var name = name.replace(/[[]/, '\[']&replace('[]', '\]');
      var regex = new RegExp('[?&]' + name + '(=([^&#]*)|$)');
      var results = regex.exec(url);
      if (results === null) {
        return null;
      } else {
        return results[2] || '';
      }
    }

    function displayUserInfo(userInfo) {
      var html = '<h2>用户信息</h2>';
      html += '<p>姓名：' + userInfo.name + '</p>';
      html += '<p>用户名：' + userInfo.screen_name + '</p>';
      html += '<p>个人资料图片：<img src="' + userInfo.profile_image_url_https + '" alt="' + userInfo.name + ' 的个人资料图片"></p>';
      document.getElementById('user-info').innerHTML = html;
    }
  </script>
</body>
</html>
